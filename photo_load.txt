/*
   URL : https://unitylog.hatenadiary.jp/entry/%E5%A4%96%E9%83%A8%E7%94%BB%E5%83%8F%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%81%BF
*/


using UnityEngine;
using UnityEditor;
using System;
using System.IO;

// Assetsフォルダ以下を見てファイルを取得する系
public class AssetDir {
    public static string[] GetFiles(string path) {
        string[] rawfiles = Directory.GetFiles(MakePath(path));
        string[] files = new string[rawfiles.Length];
        int idx = 0;
        foreach (string s in rawfiles)
            files[idx++] = Path.GetFileName(s);
        return FilterIgnoreEntries(files);
    }
    // extに拡張子を与えると該当するファイルのみ取得します
    // 拡張子リストを | で区切ると複数指定できます -> ".fbx|.prefab"
    public static string[] GetFiles(string path, string ext) {
        string[] files = GetFiles(path);
        ext = ext.ToLower();
        string[] exts = ext.Split('|');
        string[] filtered =
            Array.FindAll(files,
                delegate(string name) {
                    return
                        Array.IndexOf(exts, Path.GetExtension(name).ToLower()) >= 0;
                });
        return filtered;
    }
    private static string MakePath(string path) {
        return Application.dataPath + "/" + path;
    }
    private static string[] FilterIgnoreEntries(string[] files) {
        return
            Array.FindAll(files,
                delegate(string name) {
                    return
                        Path.GetFileName(name).IndexOf('.') != 0 &&
                        Path.GetExtension(name).ToLower() != ".meta";
                });
    }
}